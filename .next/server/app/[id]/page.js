(()=>{var e={};e.id=531,e.ids=[531],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6113:e=>{"use strict";e.exports=require("crypto")},1267:e=>{"use strict";e.exports=require("worker_threads")},5637:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.a,__next_app__:()=>m,originalPathname:()=>p,pages:()=>d,routeModule:()=>x,tree:()=>c});var s=r(3137),i=r(4647),n=r(4183),a=r.n(n),o=r(1775),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let u=s.AppPageRouteModule,c=["",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,6929)),"/Users/mirmukhammadmirsodikov/Documents/Development/sandbox/NASASpaceApps2023/sonification-web-app/app/[id]/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,5966)),"/Users/mirmukhammadmirsodikov/Documents/Development/sandbox/NASASpaceApps2023/sonification-web-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,1918,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/mirmukhammadmirsodikov/Documents/Development/sandbox/NASASpaceApps2023/sonification-web-app/app/[id]/page.tsx"],p="/[id]/page",m={require:r,loadChunk:()=>Promise.resolve()},x=new u({definition:{kind:i.x.APP_PAGE,page:"/[id]/page",pathname:"/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},6770:(e,t,r)=>{Promise.resolve().then(r.bind(r,8997))},8997:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>Sonification});var s=r(80),i=r(9885),n=r(6878),a=r(6450),o=r(4617),l=r(2490);function Model(e){let[t,r]=(0,i.useState)(new o.Pa4((e.size?.x||0)/4,0,e.size?.z||0)),l=(0,i.useRef)(),u=(0,i.useRef)();return(0,a.useFrame)(({clock:t})=>{switch(u.near=.1,l.current.position.x=(e.size?.x??0)/2*e.currentTime.current/30,e.pcd.material.size=u.current.zoom,e.view?.current){case"top":r(new o.Pa4(0,0,e.size?.z??0));break;case"bottom":r(new o.Pa4(0,0,-((e.size?.z??0)*4)));break;case"side":r(new o.Pa4(0,-((e.size?.z??0)*4),0))}}),(0,s.jsxs)("mesh",{children:[s.jsx("mesh",{ref:l,children:s.jsx(n.xuv,{position:[-((e.size?.x??0)/4),0,-((e.size?.z??0)/4)],args:[(e.size?.x||0)/2,(e.size?.y||0)/2,2.5],rotation:[0,Math.PI/2,0],material:new o.vBJ({color:"red",side:o.ehD,opacity:.5,transparent:!0})})}),s.jsx(n.M5Y,{children:s.jsx("primitive",{object:e.pcd,scale:[.5,.5,.5]})}),s.jsx(n.iKG,{ref:u,makeDefault:!0,position:t})]})}function ModelViewer(e){let t=(0,a.useLoader)(l.w,e.url),[r,u]=(0,i.useState)();return t.material.size=2.5,(0,i.useEffect)(()=>{u(new o.ZzF().setFromObject(t).getSize(new o.Pa4))},[t]),(0,s.jsxs)(a.Canvas,{className:"w-screen",style:{height:"100vh"},shadows:!0,children:[s.jsx(Model,{pcd:t,size:r,currentTime:e.currentTime,view:e.view}),s.jsx(n.zxs,{enablePan:!1})]})}var u=r(3885);let useWavesurfer=(e,t)=>{let[r,s]=(0,i.useState)();return(0,i.useEffect)(()=>{if(!e.current)return;let r=u.Z.create({...t,container:e.current});return s(r),()=>{r.destroy()}},[t,e]),r};function WaveSurferPlayer(e){let t=(0,i.useRef)(),[r,n]=(0,i.useState)(!1),[a,o]=(0,i.useState)(0),l=useWavesurfer(t,e);return(0,i.useEffect)(()=>{if(!l)return;o(0),n(!1);let t=[l.on("play",()=>n(!0)),l.on("pause",()=>n(!1)),l.on("timeupdate",t=>{o(t),e.currentTime.current=t})];return()=>{t.forEach(e=>e())}},[e.currentTime,l]),s.jsx("div",{ref:t,style:{minHeight:"120px"}})}function ToolOverlay(e){return(0,s.jsxs)("div",{className:"absolute bottom-10 w-full p-5 flex flex-row gap-10 justify-center items-center rounded-lg",children:[s.jsx("div",{className:"w-screen pl-10 ",children:s.jsx(WaveSurferPlayer,{height:60,waveColor:"rgb(125, 25, 25)",progressColor:"rgb(255, 0, 0)",url:e.url,container:"",barHeight:1,barWidth:4,barGap:2,barAlign:"bottom",barRadius:2.5,mediaControls:!0,normalize:!1,currentTime:e.currentTime})}),(0,s.jsxs)("select",{onChange:t=>{e.view.current=t.target.value},defaultValue:"select",className:"select text-lg max-w-xs bg-black text-white h-full pr-10",children:[s.jsx("option",{value:"select",disabled:!0,children:"Select view"}),s.jsx("option",{value:"top",children:"Top"}),s.jsx("option",{value:"bottom",children:"Bottom"}),s.jsx("option",{value:"side",children:"Side"}),s.jsx("option",{value:"free",children:"Free View"})]})]})}function Sonification({params:e}){let t=(0,i.useRef)(0),[r,n]=(0,i.useState)(""),[a,o]=(0,i.useState)("");(0,i.useRef)();let l=(0,i.useRef)("");return(0,i.useEffect)(()=>{let getFileUrls=async()=>{let t=await fetch(`/api/${e.id}`),r=await t.json();return r};getFileUrls().then(e=>{n(e.modelFileUrl),o(e.soundFileUrl)})},[e.id]),s.jsx(s.Fragment,{children:r&&a?(0,s.jsxs)(s.Fragment,{children:[s.jsx(ModelViewer,{view:l,currentTime:t,url:r}),s.jsx(ToolOverlay,{view:l,currentTime:t,url:a})]}):s.jsx("div",{className:"container min-h-screen flex items-center justify-center",children:s.jsx("span",{className:"loading loading-dots loading-lg"})})})}},6929:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>a,__esModule:()=>n,default:()=>l});var s=r(7536);let i=(0,s.createProxy)(String.raw`/Users/mirmukhammadmirsodikov/Documents/Development/sandbox/NASASpaceApps2023/sonification-web-app/app/[id]/page.tsx`),{__esModule:n,$$typeof:a}=i,o=i.default,l=o}};var t=require("../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[818,162,893],()=>__webpack_exec__(5637));module.exports=r})();